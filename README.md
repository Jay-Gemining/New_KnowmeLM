## KnowmeLM 产品需求文档 (PRD)

**版本**: 1.0
**日期**: 2023年10月27日 (示例日期)
**负责人**: [你的名字/团队名字]

### 1. 引言

#### 1.1 项目背景与目标
在信息爆炸的时代，个人面临着海量信息的处理压力。KnowmeLM 旨在成为一个由 AI 驱动的个人知识管理和内容概括工具，帮助用户高效地从多种来源（如文档、YouTube 视频）提取、概括和理解信息，并通过智能对话深化认知。

#### 1.2 项目愿景
打造一个智能、易用、高效的个人知识助手，让用户能够轻松管理和消化信息，将数据转化为可行动的知识。

#### 1.3 目标用户
*   **学生与研究人员**：需要快速消化大量文献、讲座视频。
*   **内容创作者与编辑**：需要从多种素材中提取核心观点。
*   **职场人士与终身学习者**：希望高效学习新知识、跟踪行业动态。

### 2. 产品概述

KnowmeLM 允许用户导入内容（通过上传文件或提供 YouTube 视频链接），利用 AI 对这些内容进行智能概括。用户可以在"笔记"中管理这些来源，并基于这些来源与 AI 进行智能对话，从而快速获取关键信息和深入理解内容。项目前端将采用 React 技术栈构建，以提供更优的交互体验和可维护性。

### 3. 功能需求

#### 3.1 核心功能：内容导入与概括

**3.1.1 YouTube 视频概括**
*   **FR1.1.1**: 用户可以通过粘贴 YouTube 视频链接导入视频。
*   **FR1.1.2**: 系统应自动下载视频字幕（优先英文，若无英文则下载任意可用语言）。
*   **FR1.1.3**: 系统应能提取字幕的纯文本内容。
*   **FR1.1.4**: 系统应调用 AI 服务对字幕文本内容进行精炼概括。
*   **FR1.1.5**: 概括结果应存储并与该 YouTube 来源关联。

**3.1.2 文件内容概括**
*   **FR1.2.1**: 用户可以上传文件作为来源，支持格式：`.txt`, `.md`, `.pdf`。
    *   *注：PDF 文件内容提取目前依赖于基础文本读取，对于复杂或扫描型 PDF 的文本提取能力有限，将在后续版本中重点改进。*
*   **FR1.2.2**: 系统应能读取所支持文件的文本内容。
*   **FR1.2.3**: 系统应调用 AI 服务对文件内容进行精炼概括。
*   **FR1.2.4**: 文件上传后，默认仅生成文本概括。
*   **FR1.2.5**: 概括结果应存储并与该文件来源关联。

**3.1.3 报告生成**
*   **FR1.3.1**: 用户可以在"深入研究"模块中，为笔记中的任一已概括来源按需生成精美的 HTML 报告。
*   **FR1.3.2**: HTML 报告应在新标签页中打开，内容基于该来源的 AI 概括。

#### 3.2 笔记管理

*   **FR2.1**: **仪表盘**：
    *   **FR2.1.1**: 应用首页应为仪表盘，展示用户创建的所有笔记列表。
    *   **FR2.1.2**: 每个笔记条目应显示笔记标题，点击标题可进入该笔记详情页。
*   **FR2.2**: **新建笔记**：
    *   **FR2.2.1**: 用户可以在仪表盘点击"新建"按钮创建新笔记。
    *   **FR2.2.2**: 新建笔记自动命名为 "Untitled notebook X" (X 为递增数字)。
*   **FR2.3**: **重命名笔记**：
    *   **FR2.3.1**: 用户可以在笔记详情页修改当前笔记的标题。
*   **FR2.4**: **笔记数据存储**：
    *   **FR2.4.1**: 笔记及其来源信息目前存储在浏览器本地存储（`localStorage`）中。
    *   *注：当前版本不支持删除笔记。*

#### 3.3 来源管理 (在笔记内部)

*   **FR3.1**: **添加来源**：
    *   **FR3.1.1**: 在笔记详情页，用户可以通过"添加"按钮打开模态框添加新来源。
    *   **FR3.1.2**: 支持通过粘贴 YouTube 链接添加视频来源。
    *   **FR3.1.3**: 支持通过文件上传区域（点击选择或拖拽）添加文件来源。
*   **FR3.2**: **来源展示**：
    *   **FR3.2.1**: 笔记的侧边栏应清晰展示所有已添加来源的列表。
    *   **FR3.2.2**: 每个来源条目应显示其类型（如 YouTube 图标、文件图标）和名称（视频标题或文件名）。
    *   **FR3.2.3**: 当笔记内无来源时，应显示友好的"暂无来源"提示信息。
*   **FR3.3**: **来源选择 (用于 AI 聊天上下文)**：
    *   **FR3.3.1**: 用户可以单独勾选或取消勾选每个来源，以决定是否将其概括内容作为 AI 聊天的上下文。
    *   **FR3.3.2**: 提供一个"选择所有来源/取消选择所有来源"的复选框，方便批量操作。
*   **FR3.4**: **删除来源**：
    *   **FR3.4.1**: 用户可以删除笔记中的单个来源。

#### 3.4 AI 聊天功能 (在笔记内部)

*   **FR4.1**: **聊天界面**：
    *   **FR4.1.1**: 笔记详情页的右侧区域应提供聊天输入框和对话展示区。
*   **FR4.2**: **上下文感知对话**：
    *   **FR4.2.1**: 用户输入问题并发送后，AI 的回答应基于当前笔记中所有**已选中**来源的概括内容作为上下文。
    *   **FR4.2.2**: 如果没有选中任何来源，AI 行为可定义为通用聊天或提示用户选择来源。
*   **FR4.3**: **对话历史**：
    *   **FR4.3.1**: 聊天界面应展示当前会话的对话历史。
    *   *注：当前版本聊天历史仅限当前会话，不持久化存储。*

### 4. 非功能需求

*   **NF1. 用户体验 (UX/UI)**：
    *   界面应简洁、直观、易于操作。
    *   关键操作应有明确的视觉反馈（如加载状态、成功/失败提示）。
    *   使用 Tailwind CSS 构建现代化、响应式的用户界面。
    *   前端使用 React 框架，以实现组件化开发，提升交互体验和可维护性。
*   **NF2. 性能**：
    *   文件上传、视频字幕下载和 AI 概括过程应有清晰的加载指示。
    *   AI 响应时间取决于外部 API，但前端应能流畅处理等待。
    *   页面加载和切换应尽可能流畅。
*   **NF3. 安全性**：
    *   OpenAI API 密钥通过 `.env` 文件配置，避免硬编码在代码中。
    *   对上传的文件名进行安全处理 (`secure_filename`)。
*   **NF4. 可维护性与可扩展性**：
    *   后端逻辑 (`backend_app.py`) 与 Flask 路由 (`know.py`) 分离。
    *   前端使用 React 组件化结构，便于维护和扩展。
    *   代码应有适当的注释。
*   **NF5. 数据存储**：
    *   用户数据（笔记、来源概括）当前存储在浏览器 `localStorage`。这适用于单用户本地使用，但限制了数据持久性和跨设备同步。

### 5. 技术栈

*   **后端**：
    *   语言/框架：Python, Flask
    *   AI 交互：OpenAI API (`openai` 库)
    *   YouTube 字幕：`yt-dlp` (命令行工具), `pysrt`
    *   文件处理：内置 I/O, `werkzeug.utils.secure_filename`
    *   环境变量：`python-dotenv`
*   **前端**：
    *   核心库/框架：React
    *   UI 框架/库：Tailwind CSS
    *   交互逻辑：JavaScript (ES6+)
*   **数据存储 (当前)**：浏览器 `localStorage`

### 6. 未来展望与改进方向 (Roadmap High-Level)

*   **P1 (高优先级)**:
    *   **PDF 文本提取增强**：集成 `PyPDF2` 或 `pdfminer.six` 提升 PDF 内容提取质量。
    *   **笔记删除功能**：实现完整的笔记管理。
    *   **用户反馈优化**：更细致的加载状态、错误提示（如 Toast 通知）。
*   **P2 (中优先级)**:
    *   **后端数据持久化**：引入 SQLite 或其他数据库存储笔记和用户信息，替代 `localStorage`。
    *   **AI 聊天增强**：聊天历史持久化、流式响应。
    *   **来源列表 UI/UX 优化**：来源概括预览、排序、搜索。
*   **P3 (低优先级/长期)**:
    *   **用户认证与多用户支持**。
    *   **笔记分享与协作**。
    *   **更丰富的 AI 模型选择与配置**。
    *   **全面的单元测试与集成测试**。

### 7. 成功指标 (初步)

*   用户创建笔记的数量。
*   用户添加来源（视频/文件）的总数。
*   AI 聊天功能的使用频率。
*   用户对概括质量和工具易用性的正面反馈。

---

这份 PRD 概述了 KnowmeLM 项目的核心需求和方向。随着项目的进展，本文档将会进行迭代和更新。